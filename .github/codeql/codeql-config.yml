# CodeQL configuration for TinyCTI security analysis

name: "TinyCTI CodeQL Config"

# Disable default queries and specify custom ones
disable-default-queries: false

# Additional queries to run
queries:
  - uses: security-and-quality
  - uses: security-extended

# Paths to ignore during analysis
paths-ignore:
  - "tests/**"
  - "docs/**"
  - "examples/**"
  - "*.md"
  - ".github/**"
  - "venv/**"
  - "__pycache__/**"
  - "*.pyc"

# Paths to specifically include
paths:
  - "tinycti.py"
  - "wsgi.py"
  - "config.yaml"
  - "TinyCTI/**"

# Query filters to reduce noise
query-filters:
  - exclude:
      id: py/unused-import
  - exclude:
      id: py/unnecessary-pass
      
# Security-focused configurations
security:
  # Focus on security-relevant code patterns
  focus:
    - authentication
    - authorization
    - input-validation
    - sql-injection
    - command-injection
    - path-traversal
    - xss
    - csrf
    - encryption
    - secrets